extends ../layout
block head
  link(rel='stylesheet', href='/stylesheets/dataTables.bootstrap.css')

block content
  .container
    .page-header
      h1 Current Event Status
    .container
      table(id='table_events').table.table-condensed.sortable
        thead
          tr
            th(data-defaultsort='desc') Issued
            th(data-defaultsort='disabled') Client
            th(data-defaultsort='disabled') Check
            th(data-defaultsort='disabled').visible-lg Output
        tbody
//          each event,i in events
//            if event.status > 0
//              tr(class="#{app.locals.checkDef(app.locals.checkDef(getEventClass(event.status)))}", id="row-#{app.locals.checkDef(app.locals.checkDef(i))}")
//                td(data-value="#{app.locals.checkDef(app.locals.checkDef(event.issued))}") #{app.locals.checkDef(app.locals.checkDef(getFormattedTimestamp(event.issued)))}
//                td #{app.locals.checkDef(app.locals.checkDef(event.client))}
//                  button(onclick="silenceChecks('#{app.locals.checkDef(app.locals.checkDef(event.client))}', false);").btn.btn-default.btn-xs.pull-left
//                    span.glyphicon.glyphicon-volume-off
//                td #{app.locals.checkDef(app.locals.checkDef(event.check))}
//                  button(onclick="silenceChecks('#{app.locals.checkDef(app.locals.checkDef(event.client))}', '#{app.locals.checkDef(app.locals.checkDef(event.check))}');").btn.btn-default.btn-xs.pull-left
//                    span.glyphicon.glyphicon-volume-off
//                td.visible-lg #{app.locals.checkDef(app.locals.checkDef(event.output.slice(0,65)))}
block footer
  script(src='/javascripts/jquery.dataTables.min.js')
  script(src='/javascripts/dataTables.bootstrap.js')
  script(type='text/javascript').
    $(document).ready(function() {
      $('#table_events').dataTable( {
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "sPaginationType": "bootstrap",
        "sAjaxSource": '/sensu/events',
        "iDisplayLength": 10,
        "bSortClasses": false,
        "aoColumns": [
          {
            "mData": "issued"
          }, {
            "mData": "client",
            "mRender": function (client) {
              return '<a href="/ubersmith/devices/hostname/'+client+'">' + client + '</a>';
            }
          }, {
            "mData": "check"
          }, {
            "mData": "output",
            "mRender": function (output) {
              return output.slice(0,65);
            }
          }],
        "aaSorting": [[1,'asc']],
        "oLanguage": {
          "sLengthMenu": "_MENU_ records per page"
        }
      });
    });